window.czosnek=function(){function z(a,b,f){this.root=a;this.parent=b;this.maps=f}function l(a,b,f,d,e,g,c){var k=null!==b.match(Y),q=-1!==Z.indexOf(e);if(k&&1<c.length)return console.error("No spaces or extra content can accompany loop binds "+b);if(q&&1<c.length)return console.error("No spaces or extra content can accompany event binds "+b);this.text=b;this.key=k?b.replace(aa,""):b.replace(ba,"");this.keySplit=this.key.split(".");this.keyLength=this.keySplit.length;this.localKey=this.keySplit.pop();
this.loopId=(this.isLoop=k)?F():void 0;this.loopComponent=k?b.replace(ca,""):void 0;var m=G(b),h={filters:[],vmFilters:[],model:[],local:[],session:[]};"string"===typeof m&&(m=G(m));if(m.length){var n=0,p=m.length;for(n;n<p;n++){var l=m[n];l.match(da)?h.vmFilters.push(l.replace(ea,"")):l.match(fa)?(-1!==l.indexOf("~")&&h.model.push(l.replace(B,"")),-1!==l.indexOf("+")&&h.local.push(l.replace(B,"")),-1!==l.indexOf("-")&&h.session.push(l.replace(B,""))):h.filters.push(l)}}this.filters=h;this.listener=
e;this.property=q?e:g;this.local=q?d:f;this.node=d;this.mapText=c.length?c:[this];this.maps=this.mapText.filter(ha);this.mapIndex=this.maps.length;this.mapTextIndex=this.mapText.indexOf(b);this.submaps=[];this.isEvent=q;this.isRadio=(this.isInput="INPUT"===d.tagName)&&-1!==["radio","checkbox"].indexOf(d.type);this.isInsert=null!==b.match(ia);this.isDirty=1!==this.mapText.length||"innerHTML"===this.key;this.type=k?"LOOP":q?"EVENT":this.isInput?"INPUT":a}function u(a,b,f,d){return{value:a,writable:!!b,
enumerable:!!d,configurable:!!f}}function x(a){return a.split(v).filter(Boolean)}function G(a){return a.match(ja)?a.replace(ka,"").split(","):[]}function H(a,b,f){var d=document.createElement("style");d.setAttribute("type","text/css");d.setAttribute("component",b);d.setAttribute(f?"k-"+f:"global","");d.textContent=a;return d}function A(a){a=a.match(I);var b=[],f=a.length,d=0;for(d;d<f;d++){var e=a[d].replace(I,"$1");(-1!==e.indexOf("-")||document.createElement(e)instanceof HTMLUnknownElement)&&-1===
b.indexOf(e)&&void 0===r[e]&&b.push(e)}return b}function C(a){return-1!==a.nodeName.indexOf("-")||a instanceof HTMLUnknownElement}function la(a,b){var f=[],d=x(a.textContent),e=d.length,g=0;for(g;g<e;g++){var c=d[g];c.match(v)&&(d[g]=new l("TEXT",d[g],a,b,"html","textContent",d),f[f.length]=d[g])}return f}function J(a,b){if(!a.textContent.match(v))return[];var f=[],d=b?"[k-"+b+"]":"[global]",e=x(a.textContent),g=e.length,c=0;b&&(a.textContent=a.textContent.replace(K,d));for(c;c<g;c++){var k=e[c];
var q=0;if(b&&k.match(K))e[c]=d;else if(k.match(v)){var m=e[c-1];k=e[c+1];"string"!==typeof m||"string"!==typeof k||m.match(v)||(q=(m+e[c]+(k.match(ma)||"")).match(na),q=k.match(oa)?1:q&&-1===q[0].indexOf(";")?2:0);switch(q){case 0:if(!h&&k&&0===k.indexOf(":")){e[c]=new l("STYLE_NAME",e[c],a,a,"html","textContent",e);var h=e[c].submaps}else h?(e[c]="",h[h.length]=new l("STYLE_VALUE",e[c],a,a,"html","textContent",h)):e[c]=new l("STYLE",e[c],a,a,"html","textContent",e);break;case 1:e[c]=new l("STYLE_PROPERTY",
e[c],a,a,"html","textContent",e);break;case 2:e[c]=new l("STYLE_FULL",e[c],a,a,"html","textContent",e)}"string"!==typeof e[c]&&(f[f.length]=e[c])}else h&&((q=k.match(pa))?(e[c]=e[c].replace(q[0],""),h[h.length]=q[0].replace(/[:;]/g,"")):(e[c]="",h[h.length]=k),-1!==k.indexOf(";")&&(h=null))}return f}function D(a,b,f,d){var e=[];if(8===b.nodeType)return e;switch(b.nodeType){case 3:if(""===b.textContent)return e;Object.defineProperty(b,"__Czosnek__",u(new z(b,d,la(b,f))));return b.__Czosnek__.maps;
case 11:if(1!==b.childNodes.length)return console.error("Components may only have one root element",a);break;default:b.setAttribute("k-"+f,"");b.setAttribute("component",a);e=[];var g=b.attributes["data-knode"],c=b.attributes["data-kattr"],k=b.attributes["data-kstyle"];g&&(e=[new l("NODE",g.value,b,b,"nodeName","nodeName",[])],b.removeAttribute("data-knode"));if(c){g=e;c=c.value.split(";").filter(Boolean);var q=c.length,m=0;for(m;m<q;m++){var h=c[m].split(":");var n=[];if(1===h.length)n=new l("ATTRIBUTE_FULL",
h[0],b,b,void 0,void 0,n);else{h[1]=h[1].replace(qa,"");n=new l("ATTRIBUTE_NAME",h[0],b,b,void 0,void 0,n);n.submaps=x(h[1]);h=n.submaps;var p=h.length;var r=0;for(r;r<p;r++){var t=h[r];t.match(v)&&(h[r]=new l("ATTRIBUTE_VALUE",t,n,b,void 0,void 0,h))}}g[g.length]=n}b.removeAttribute("data-kattr")}if(k){g=e;k=k.value.split(";").filter(Boolean);c=[];q=k.length;m=0;if(1===q&&-1===k[0].indexOf(":"))c=new l("STYLE_INLINE_FULL",k[0],b.style,b,void 0,void 0,c),g[g.length]=c;else for(m;m<q;m++)if(p=k[m].split(":"),
c=[],1===p.length)c=new l("STYLE_INLINE_PROPERTY",p[0],b.style,b,void 0,void 0,c),g[g.length]=c;else if(p[0].match(v)){c=new l("STYLE_INLINE_NAME",p[0],b.style,b,void 0,void 0,c);c.submaps=x(p[1]);p=c.submaps;h=p.length;t=0;for(t;t<h;t++)n=p[t],n.match(v)&&(p[t]=new l("STYLE_INLINE_VALUE",n,b.style,b,void 0,void 0,p));g[g.length]=c}else for(c=x(p[1]),h=c.length,t=0,t;t<h;t++)n=c[t],n.match(v)&&(c[t]=new l("STYLE_INLINE_VALUE",n,b.style,b,p[0],p[0],c),g[g.length]=c[t]);b.removeAttribute("data-kstyle")}k=
b.attributes;g=e;c=C(b);m=k.length;h=0;for(h;h<m;h++)if(q=k[h],q.value.match(v))for(n=x(q.value),t=n.length,p=0,p;p<t;p++)n[p].match(v)&&(n[p]=new l(c?"POINTER":"ATTRIBUTE",n[p],q,b,q.name,"value",n),g[g.length]=n[p],n[p].isEvent&&(b.removeAttribute(q.name),k=b.attributes,m=k.length));Object.defineProperty(b,"__Czosnek__",u(new z(b,d,e)))}if(b.childNodes.length)for(d=e.push,k=b.childNodes.length,g=0,g;g<k;g++)d.apply(e,D(a,b.childNodes[g],f,11!==b.nodeType?b:void 0,e)),k=b.childNodes.length;return e}
function L(a,b){var f=Object.create(r[a]),d=document.head.querySelector('style[component="'+a+'"][global]');b=b||_uuid();f.global=d||H(f.global,a);f.local=H(f.local,a,b);d=f.html;var e=document.createElement("div"),g=document.createDocumentFragment();e.innerHTML=d;d=e.children[0];d.setAttribute("root","");d.setAttribute("k-"+b,"");d.setAttribute("component",a);g.appendChild(d);f.html=g;return f}function M(a){a=a||this;var b=document.head.querySelector("[k-"+a.id+"]"),f=document.body.querySelector("[k-"+
a.id+"]");E.splice(E.indexOf(a),1);a.expanded=null;a.maps=null;b&&b.parentElement.removeChild(b);f&&f.parentElement.removeChild(f);0===document.body.querySelectorAll('[component="'+a.title+'"').length&&(a=document.head.querySelector('[component="'+a.title+'"'))&&a.parentElement.removeChild(a)}function N(a){O(a,document.querySelectorAll('[component="'+a+'"]'),P[a]);r[a]=void 0;P[a]=void 0;Q(a,document.querySelectorAll('[component="'+a+'"]'));return this}function R(a){return void 0!==r[a]}function F(){var a=
new Uint8Array(8),b=a.length,f=0,d=0;for(f;f<b;f++)a[f]=Math.floor(99*Math.random()+1);a[6]=a[6]&15|64;a[8]=a[8]&15|128;return[w[a[d++]],w[a[d++]],w[a[d++]],w[a[d++]],w[a[d++]],w[a[d++]],w[a[d++]],w[a[d++]]].join("")}function ha(a){return a&&a.constructor===l}function y(a){if(!R(a))return console.error("No component registered by the name",a);this.title=a;this.id=S();this.expanded=L(a,this.id);this.unknowns=r[a].unknowns;T(this.expanded);var b=this.expanded,f=this.id,d=b.global;b=b.local;d.__Czosnek__||
Object.defineProperty(d,"__Czosnek__",u(new z(d,document.head,J(d))));Object.defineProperty(b,"__Czosnek__",u(new z(b,document.head,J(b,f))));this.maps=[].concat(d.__Czosnek__.maps).concat(b.__Czosnek__.maps).concat(D(a,this.expanded.html,this.id));U(this.maps);E.push(this)}var r={},w=Array.apply(null,Array(256)).map(function(a,b){return(b+256).toString(16).substr(1)}),Z=Object.keys(HTMLElement.prototype).filter(function(a){return 0===a.indexOf("on")}).concat("onDOMContentLoaded onDOMAttributeNameChanged onDOMAttrModified onDOMCharacterDataModified onDOMNodeInserted onDOMNodeRemoved onDOMSubtreeModified".split(" ")).map(function(a){return a.toLowerCase()}),
E=[],P={},S=F,V=function(){},W=function(){},O=function(){},Q=function(){},T=function(){},U=function(){},I=/<\/(.*?)>/g,ra=/(<.*?([^{]>))/g,sa=/({{(?:(?!{{).)*?}}=["'].*?["'])|({{(?:(?!{{).)*?}}(?!.*?[="]))/g,ta=/(style=["'].*?{{.*?}}.*?["'])/g,ua=/(<(?!input|img)(.*?) (.*?)\/>)/g,va=/(<({{(.*?)}})(.*?)>)/g,wa=/(<\/({{(.*?)}})>)/g,na=/(({([\s\r\n\t]+)?{{.[^}]*?}}([\s\r\n\t]+)?})([\s\r\n\t]+)?)$/g,K=/({{>?local}})/g,X=/(([^};][\s\w\.]+?)?{{>?local}}(([\r\n\s\S]*?{(([\r\n\s\W\w]+?)|(.*?))(?:[^}])}(?=[\n\.\r\s]|$))|(((.[^;\r\n\t\u21b5]*?)({{.[^}]*?}})(\s+)?)$)))/g,
oa=/^((\s+)?;)/g,ma=/^(([\s\r\n\t]+)?})/g,pa=/(^(\s+)?:(\s+)?(.*?);)|(^(\s+)?:([\s\w\W]+)?)|(^([\s\w\W]+)?;)/g,v=/(?!\{\{\{)(?!\}\}\})(\{\{.*?\}\})/g,ba=/[\s\{\}>]|(\|(.*))/g,ja=/(\{\{(.*?)\|(.*?)\}\})/g,ka=/(.*?)\||[\s\{\}]/g,da=/(\()(.*?)(\))/g,ea=/[\(\)]/g,fa=/(\[)(.*?)(\])/g,B=/[\[\]~\+\-]/g,Y=/((.*?)for)(.*?)(loop(.*))/g,aa=/((.*?)for\s)|(\sloop(.*))/g,ca=/(.*?loop\s)|(\|(.*))|[\s]/g,ia=/(\{\{(\s*)>(.*?)(\}\}))/g,qa=/(^['])|([']$)/g;y.prototype.destruct=M;Object.defineProperties(y,{hook:u(function(a,
b){if(b.constructor!==Function)return this;switch(a){case "beforeRegister":V=b;case "afterRegister":W=b;case "beforeUnregister":O=b;case "afterUnregister":Q=b;case "beforeMap":T=b;case "afterMap":U=b;case "uuid":S=b}},!1,!0),map:u(D,!1,!0),register:u(function(a,b,f){V(a,{html:b,style:{local:"",global:f}});if(void 0===r[a]){b=b.replace(ua,"<$2 $3></$2>").replace(/( >)/g,">").replace(va,'<knode data-knode="$2" $4>').replace(wa,"</knode>");var d=b.match(ra),e=d.length,g=0,c;for(g;g<e;g++){var k=d[g];
if(c=k.match(sa)){var l=c.length;var m=0;for(m;m<l;m++){var h=c[m];c[m]=h.replace("=",":").replace(/["]/g,"'")+";";d[g]=k.replace(h,"")}d[g]=k.replace(">",'data-kattr="'+c.join("")+'">')}k.match(ta)&&(d[g]=k.replace("style=","data-kstyle="));b=b.replace(k,d[g])}r[a]={html:b,local:f&&f.match(X).join("\r\n")||"",global:f&&f.replace(X,"")||""};r[a].unknowns=A(r[a].html);W(a,r[a])}else console.error("ERR: A template by the name %o already exists",name,Error().stack);return this},!1,!0),unregister:u(N,
!1,!0),isRegistered:u(R,!1,!0),clearRegistry:u(function(){var a=Object.keys(r),b=a.length,f=0;for(f;f<b;f++)N(a[f]);return this},!1,!0),getUnknown:u(function(a){if("string"===typeof a)return A(a);if("string"===typeof a)a=A(a);else{var b=A(a.innerHTML);a=C(a)?[a.nodeName.toLowerCase()].concat(b):b}return a},!1,!0),isUnknown:u(function(a){return"string"===typeof a?-1!==a.indexOf("-")||document.createElement(a)instanceof HTMLUnknownElement:C(a)},!1,!0),expand:u(L,!1,!0),destruct:u(M,!1,!0)});"function"===
typeof define&&define.amd&&define("czosnek",function(){return y});"object"===typeof module&&"object"===typeof module.exports&&(module.exports.czosnek=y);return y}();